"use strict";

require("source-map-support/register");

class DeferredQueue {
  constructor(app, storageModel, processTimeout) {
    this.app = app;
    this.storage = this.app.model(storageModel);
    this.processTimeout = processTimeout || 600000;
  }

  genreateBatchId() {
    const {
      Generators
    } = require('@genx/data');

    return Generators.shortid();
  }

  async postJobRequest_(job, deferedTime) {
    const now = this.app.now();
    const due = now.plus({
      milliseconds: deferedTime || 3000
    });
    const queuedJob = await this.storage.create_({
      job: JSON.stringify(job),
      dueAt: due,
      batchId: '*'
    }, null, {
      insertIgnore: true
    });
    return queuedJob;
  }

  async popExpiredRequests_() {
    const expired = this.app.now().minus({
      milliseconds: this.processTimeout
    });
    const lockerId = this.genreateBatchId();
    const updated = await this.storage.updateMany_({
      lockerId
    }, {
      $query: {
        batchId: {
          $neq: '*'
        },
        dispatchedAt: {
          $lte: expired
        },
        lockerId: {
          $exists: false
        }
      },
      $retrieveUpdated: {
        $query: {
          lockerId
        }
      }
    });

    if (updated.length > 0) {
      await this.remove_({
        lockerId
      });
    }

    return updated;
  }

  async processDueRequests_() {
    const now = this.app.now();
    const batchId = this.genreateBatchId();
    const updated = await this.storage.updateMany_({
      batchId,
      dispatchedAt: now
    }, {
      $query: {
        batchId: '*',
        dueAt: {
          $lte: now
        }
      },
      $retrieveUpdated: {
        $query: {
          batchId
        }
      }
    });
    return updated;
  }

  async remove_(conditon) {
    await this.storage.deleteMany_(conditon);
  }

  async removeById_(id) {
    await this.storage.deleteOne_(id);
  }

  async clearQueue_() {
    await this.storage.deleteAll_();
  }

  async getBatchStatus_() {
    const batchStats = await this.storage.findAll_({
      $projection: ['batchId', this.storage.db.connector.queryCount(null, "batchId")],
      $query: {
        lockerId: {
          $exists: false
        }
      },
      $groupBy: ['batchId'],
      $skipOrm: true
    });
    let pending = 0,
        processing = 0,
        batches = {};
    batchStats.forEach(batch => {
      if (batch[0] === '*') {
        pending = batch[1];
      } else {
        batches[batch[0]] = batch[1];
        processing += batch[1];
      }
    });
    return {
      numPending: pending,
      numProcessing: processing,
      batches
    };
  }

}

module.exports = DeferredQueue;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9EZWZlcnJlZFF1ZXVlLmpzIl0sIm5hbWVzIjpbIkRlZmVycmVkUXVldWUiLCJjb25zdHJ1Y3RvciIsImFwcCIsInN0b3JhZ2VNb2RlbCIsInByb2Nlc3NUaW1lb3V0Iiwic3RvcmFnZSIsIm1vZGVsIiwiZ2VucmVhdGVCYXRjaElkIiwiR2VuZXJhdG9ycyIsInJlcXVpcmUiLCJzaG9ydGlkIiwicG9zdEpvYlJlcXVlc3RfIiwiam9iIiwiZGVmZXJlZFRpbWUiLCJub3ciLCJkdWUiLCJwbHVzIiwibWlsbGlzZWNvbmRzIiwicXVldWVkSm9iIiwiY3JlYXRlXyIsIkpTT04iLCJzdHJpbmdpZnkiLCJkdWVBdCIsImJhdGNoSWQiLCJpbnNlcnRJZ25vcmUiLCJwb3BFeHBpcmVkUmVxdWVzdHNfIiwiZXhwaXJlZCIsIm1pbnVzIiwibG9ja2VySWQiLCJ1cGRhdGVkIiwidXBkYXRlTWFueV8iLCIkcXVlcnkiLCIkbmVxIiwiZGlzcGF0Y2hlZEF0IiwiJGx0ZSIsIiRleGlzdHMiLCIkcmV0cmlldmVVcGRhdGVkIiwibGVuZ3RoIiwicmVtb3ZlXyIsInByb2Nlc3NEdWVSZXF1ZXN0c18iLCJjb25kaXRvbiIsImRlbGV0ZU1hbnlfIiwicmVtb3ZlQnlJZF8iLCJpZCIsImRlbGV0ZU9uZV8iLCJjbGVhclF1ZXVlXyIsImRlbGV0ZUFsbF8iLCJnZXRCYXRjaFN0YXR1c18iLCJiYXRjaFN0YXRzIiwiZmluZEFsbF8iLCIkcHJvamVjdGlvbiIsImRiIiwiY29ubmVjdG9yIiwicXVlcnlDb3VudCIsIiRncm91cEJ5IiwiJHNraXBPcm0iLCJwZW5kaW5nIiwicHJvY2Vzc2luZyIsImJhdGNoZXMiLCJmb3JFYWNoIiwiYmF0Y2giLCJudW1QZW5kaW5nIiwibnVtUHJvY2Vzc2luZyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7QUFPQSxNQUFNQSxhQUFOLENBQW9CO0FBQ2hCQyxFQUFBQSxXQUFXLENBQUNDLEdBQUQsRUFBTUMsWUFBTixFQUFv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QUssQ0FBQyxDQUFELENBQU4sQ0FBUCxHQUFvQkEsS0FBSyxDQUFDLENBQUQsQ0FBekI7QUFDQUgsUUFBQUEsVUFBVSxJQUFJRyxLQUFLLENBQUMsQ0FBRCxDQUFuQjtBQUNIO0FBQ0osS0FQRDtBQVNBLFdBQU87QUFDSEMsTUFBQUEsVUFBVSxFQUFFTCxPQURUO0FBRUhNLE1BQUFBLGFBQWEsRUFBRUwsVUFGWjtBQUdIQyxNQUFBQTtBQUhHLEtBQVA7QUFLSDs7QUF0SGU7O0FBeUhwQkssTUFBTSxDQUFDQyxPQUFQLEdBQWlCaEUsYUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyJcbi8qKlxuICogaWQsIGpvYiwgZHVlQXQsIHN0YXR1cywgYmF0Y2hJZCAoZGVmYXVsdCAnKicpLCBkaXNwYXRjaGVkQXQsIGxvY2tGbGFnXG4gKiB1bmlxdWVLZXlzOiBbIGpvYiwgYmF0Y2hJZCBdXG4gKiBcbiAqIHRvZG86IGF1dG9tYXRpY2FsbHkgY3JlYXRlIGRiIHN0cnVjdHVyZSBpZiBub3QgZXhpc3RcbiAqL1xuY2xhc3MgRGVmZXJyZWRRdWV1ZSB7ICAgIFxuICAgIGNvbnN0cnVjdG9yKGFwcCwgc3RvcmFnZU1vZGVsLCBwcm9jZXNzVGltZW91dCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5zdG9yYWdlID0gdGhpcy5hcHAubW9kZWwoc3RvcmFnZU1vZGVsKTtcbiAgICAgICAgdGhpcy5wcm9jZXNzVGltZW91dCA9IHByb2Nlc3NUaW1lb3V0IHx8IDYwMDAwMDtcbiAgICB9XG5cbiAgICBnZW5yZWF0ZUJhdGNoSWQoKSB7XG4gICAgICAgIGNvbnN0IHsgR2VuZXJhdG9ycyB9ID0gcmVxdWlyZSgnQGdlbngvZGF0YScpO1xuICAgICAgICByZXR1cm4gR2VuZXJhdG9ycy5zaG9ydGlkKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgcG9zdEpvYlJlcXVlc3RfKGpvYiwgZGVmZXJlZFRpbWUpIHtcbiAgICAgICAgY29uc3Qgbm93ID0gdGhpcy5hcHAubm93KCk7XG4gICAgICAgIGNvbnN0IGR1ZSA9IG5vdy5wbHVzKHsgbWlsbGlzZWNvbmRzOiBkZWZlcmVkVGltZSB8fCAzMDAwIH0pO1xuXG4gICAgICAgIGNvbnN0IHF1ZXVlZEpvYiA9IGF3YWl0IHRoaXMuc3RvcmFnZS5jcmVhdGVfKHtcbiAgICAgICAgICAgIGpvYjogSlNPTi5zdHJpbmdpZnkoam9iKSxcbiAgICAgICAgICAgIGR1ZUF0OiBkdWUsXG4gICAgICAgICAgICBiYXRjaElkOiAnKidcbiAgICAgICAgfSwgbnVsbCwge1xuICAgICAgICAgICAgaW5zZXJ0SWdub3JlOiB0cnVlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBxdWV1ZWRKb2I7XG4gICAgfVxuXG4gICAgYXN5bmMgcG9wRXhwaXJlZFJlcXVlc3RzXygpIHtcbiAgICAgICAgY29uc3QgZXhwaXJlZCA9IHRoaXMuYXBwLm5vdygpLm1pbnVzKHsgbWlsbGlzZWNvbmRzOiB0aGlzLnByb2Nlc3NUaW1lb3V0IH0pO1xuICAgICAgICBjb25zdCBsb2NrZXJJZCA9IHRoaXMuZ2VucmVhdGVCYXRjaElkKCk7XG5cbiAgICAgICAgY29uc3QgdXBkYXRlZCA9IGF3YWl0IHRoaXMuc3RvcmFnZS51cGRhdGVNYW55Xyh7ICAgICAgICAgICAgXG4gICAgICAgICAgICBsb2NrZXJJZFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICAkcXVlcnk6IHtcbiAgICAgICAgICAgICAgICBiYXRjaElkOiB7ICRuZXE6ICcqJyB9LFxuICAgICAgICAgICAgICAgIGRpc3BhdGNoZWRBdDogeyAkbHRlOiBleHBpcmVkIH0sXG4gICAgICAgICAgICAgICAgbG9ja2VySWQ6IHsgJGV4aXN0czogZmFsc2UgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICRyZXRyaWV2ZVVwZGF0ZWQ6IHtcbiAgICAgICAgICAgICAgICAkcXVlcnk6IHtcbiAgICAgICAgICAgICAgICAgICAgbG9ja2VySWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh1cGRhdGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmVtb3ZlXyh7IGxvY2tlcklkIH0pO1xuICAgICAgICB9ICAgICAgICBcblxuICAgICAgICByZXR1cm4gdXBkYXRlZDtcbiAgICB9XG5cbiAgICBhc3luYyBwcm9jZXNzRHVlUmVxdWVzdHNfKCkge1xuICAgICAgICBjb25zdCBub3cgPSB0aGlzLmFwcC5ub3coKTtcbiAgICAgICAgY29uc3QgYmF0Y2hJZCA9IHRoaXMuZ2VucmVhdGVCYXRjaElkKCk7ICAgICAgICBcblxuICAgICAgICBjb25zdCB1cGRhdGVkID0gYXdhaXQgdGhpcy5zdG9yYWdlLnVwZGF0ZU1hbnlfKHsgICAgICAgICAgICBcbiAgICAgICAgICAgIGJhdGNoSWQsXG4gICAgICAgICAgICBkaXNwYXRjaGVkQXQ6IG5vd1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICAkcXVlcnk6IHtcbiAgICAgICAgICAgICAgICBiYXRjaElkOiAnKicsXG4gICAgICAgICAgICAgICAgZHVlQXQ6IHsgJGx0ZTogbm93IH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAkcmV0cmlldmVVcGRhdGVkOiB7XG4gICAgICAgICAgICAgICAgJHF1ZXJ5OiB7XG4gICAgICAgICAgICAgICAgICAgIGJhdGNoSWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB1cGRhdGVkO1xuICAgIH1cblxuICAgIGFzeW5jIHJlbW92ZV8oY29uZGl0b24pIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zdG9yYWdlLmRlbGV0ZU1hbnlfKGNvbmRpdG9uKTtcbiAgICB9XG5cbiAgICBhc3luYyByZW1vdmVCeUlkXyhpZCkge1xuICAgICAgICBhd2FpdCB0aGlzLnN0b3JhZ2UuZGVsZXRlT25lXyhpZCk7XG4gICAgfVxuXG4gICAgYXN5bmMgY2xlYXJRdWV1ZV8oKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc3RvcmFnZS5kZWxldGVBbGxfKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0QmF0Y2hTdGF0dXNfKCkge1xuICAgICAgICBjb25zdCBiYXRjaFN0YXRzID0gYXdhaXQgdGhpcy5zdG9yYWdlLmZpbmRBbGxfKHtcbiAgICAgICAgICAgICRwcm9qZWN0aW9uOiBbXG4gICAgICAgICAgICAgICAgJ2JhdGNoSWQnLFxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZS5kYi5jb25uZWN0b3IucXVlcnlDb3VudChudWxsLCBcImJhdGNoSWRcIilcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAkcXVlcnk6IHtcbiAgICAgICAgICAgICAgICBsb2NrZXJJZDogeyAkZXhpc3RzOiBmYWxzZSB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJGdyb3VwQnk6IFtcbiAgICAgICAgICAgICAgICAnYmF0Y2hJZCdcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAkc2tpcE9ybTogdHJ1ZVxuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgcGVuZGluZyA9IDAsIHByb2Nlc3NpbmcgPSAwLCBiYXRjaGVzID0ge307XG5cbiAgICAgICAgYmF0Y2hTdGF0cy5mb3JFYWNoKGJhdGNoID0+IHtcbiAgICAgICAgICAgIGlmIChiYXRjaFswXSA9PT0gJyonKSB7XG4gICAgICAgICAgICAgICAgcGVuZGluZyA9IGJhdGNoWzFdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBiYXRjaGVzW2JhdGNoWzBdXSA9IGJhdGNoWzFdO1xuICAgICAgICAgICAgICAgIHByb2Nlc3NpbmcgKz0gYmF0Y2hbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBudW1QZW5kaW5nOiBwZW5kaW5nLFxuICAgICAgICAgICAgbnVtUHJvY2Vzc2luZzogcHJvY2Vzc2luZyxcbiAgICAgICAgICAgIGJhdGNoZXNcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gRGVmZXJyZWRRdWV1ZTsiXX0=